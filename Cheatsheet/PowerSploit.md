# [PowerSploit](https://github.com/PowerShellMafia/PowerSploit) cheatsheet

## Setup PowerSploit

```
git clone https://github.com/PowerShellMafia/PowerSploit.git
cd ./PowerSploit-master
import-module .\PowerSploit.psm1
```

## Enumeration

```
Get-NetUser "*username*"
Get-NetGroupe "*admin*"
Get-NetGroupMember "groupname"
```

## Manual LDAP filter

```
Get-NetUser -Filter "(field=*value*)"
Get-NetUser -Filter "(mail=john@apple.com)"
```

## I Hunt Sysadmins

```
Invoke-UserHunter -ShowAll
Invoke-UserHunter -ShowAll -Stealth (lot less traffic)
Invoke-UserHunter -TargetServer "host" (useful to hunt user who can admin a particular server)
```

## Group Policy Preferences

```
Get-GPPPassword (find and decrypt credentials in Group Policy Preference files on a DC's SYSVOL)
```

## Trust enumeration

```
Get-NetForest (info about the current forest)
Get-NetForestDomain (grab all domains in a forest)
Get-NetForestTrust (grab all forest trusts)
Get-NetDomainTrust (grab all domain trusts)
```

If a trust exists, most functions in PowerView can accept option ```-Domain "domain"``` flag to operate across a trust

```
Invoke-MapDomainTrust (map all reachable domain and forest trusts)
```

## Trust Explorer Graph

```
git clone https://github.com/sixdub/DomainTrustExplorer.git && cd ./DomainTrustExplorer-master
pip install networkx matplotlib
Invoke-MapDomainTrust | Export-CSV -NoTypeInformation trusts.csv
python.exe .\trust_explorer.py -f .\trusts.csv -g
```

- - -

## Resources:

[HarmJ0y's Slide "I have the powerview"](http://www.slideshare.net/harmj0y/i-have-the-powerview)
