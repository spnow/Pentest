#! /usr/bin/perl
use strict;
use warnings;
use LWP;
use constant PERL_EOL => "\n";
my $ARGC = @ARGV;
my $notice =
"[~] Wh4t D4 FuCk scanner by \@tfairane
[~] scan for secret/hidden/unlinked/temporary - folders/files on website
[~] dictionary mode only
[~] notice : ".$0." <target> <port> <dico>
[~] report : tf.airane[at]gmail[dot]com";
print $notice;
exit() if($ARGC!=3);

# config connection
my( $host, $port, $dico) = (
	$ARGV[0],
	$ARGV[1],
	$ARGV[2]);
# define User Agent
my $agent = LWP::UserAgent->new;
$agent->agent("Wh4t D4 FuCk scanner");
print "[+] start scan on ".$host.PERL_EOL.PERL_EOL;
# open Dictionary
open *hFolderListing, "<".$dico or die();
while(<hFolderListing>) {
	chomp $_;
	# request HTTP Server
	my $req = HTTP::Request->new('GET', 'http://'.$host.':'.$port.'/'.$_);
	# print HTTP return code ('200' means folder exist)
	print $_." OK".PERL_EOL if($agent->request($req)->as_string() =~ /^HTTP\/1.1 200 OK/ig);
}
print PERL_EOL."[+] end of doom";
